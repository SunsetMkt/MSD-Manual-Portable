<!DOCTYPE html>
<!--
    MSD-Manual-Portable
    A method to build a portable and offline-available MSD Manual.
    https://github.com/SunsetMkt/MSD-Manual-Portable

    Index Page
    Home page of the MSD-Manual-Portable.
-->
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1, shrink-to-fit=no"
        />
        <title>Home - MSD-Manual-Portable</title>
        <link rel="stylesheet" href="bootstrap.min.css" />
        <script src="jquery.min.js"></script>
        <script src="bootstrap.bundle.min.js"></script>
        <style>
            /* Custom styles for interaction */
            #pearl-container {
                transition: background-color 0.2s;
                position: relative;
            }
            #pearl-container.clickable {
                cursor: pointer;
            }
            #pearl-container.clickable:hover {
                background-color: #d1ecf1; /* Slightly darker alert-info color */
            }
            #pearl-container.clickable:active {
                background-color: #c6e0f5;
            }
            .click-hint {
                font-size: 0.8rem;
                opacity: 0.7;
                margin-top: 10px;
                text-align: right;
                display: none; /* Hidden by default until data loads */
            }
        </style>
    </head>

    <body>
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <a class="navbar-brand" href="index.html">MSD-Manual-Portable</a>
            <button
                class="navbar-toggler"
                type="button"
                data-toggle="collapse"
                data-target="#navbarNav"
                aria-controls="navbarNav"
                aria-expanded="false"
                aria-label="Toggle navigation"
            >
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="menu.html">Menu</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="search.html">Search</a>
                    </li>
                    <li class="nav-item">
                        <a
                            class="nav-link"
                            href="https://github.com/SunsetMkt/MSD-Manual-Portable"
                            >About</a
                        >
                    </li>
                </ul>
            </div>
        </nav>
        <br />
        <!--Title and info in center-->
        <div class="container">
            <div class="jumbotron">
                <h1 class="display-4">MSD-Manual-Portable</h1>
                <p class="lead">
                    A method to build a portable and offline-available MSD
                    Manual.
                </p>
                <hr class="my-4" />
                <p>This is the home page of your portable MSD Manual.</p>
                <p>
                    <a href="https://www.msdmanuals.com/professional"
                        >The Merck Manual of Diagnosis and Therapy</a
                    >, referred to as The Merck Manual, is the world's
                    best-selling medical textbook, and the oldest continuously
                    published English language medical textbook.
                </p>
                <p>
                    This folder contains a mirror of The Merck Manual of
                    Diagnosis and Therapy. This project is not affiliated with
                    Merck & Co, Inc., Rahway, NJ,USA.
                </p>
                <p>Datapack build time: <span id="version">unknown</span></p>
                <!--two buttons to menu and search-->
                <p>
                    <a
                        class="btn btn-primary btn-lg"
                        href="menu.html"
                        role="button"
                        >Menu</a
                    >
                    <a
                        class="btn btn-primary btn-lg"
                        href="search.html"
                        role="button"
                        >Search</a
                    >
                </p>
            </div>
        </div>

        <!--Pearls Section-->
        <div class="container">
            <!-- Added ID 'pearl-container' for JS manipulation -->
            <div class="alert alert-info" role="alert" id="pearl-container">
                <h4 class="alert-heading" id="pearl-title">
                    Loading Pearls...
                </h4>
                <p id="pearl-content">Please wait...</p>
                <!-- Added a hint text -->
                <div id="pearl-hint" class="click-hint">
                    Click box to refresh content
                </div>
            </div>
        </div>

        <!--Disclaimer-->
        <div class="container">
            <div class="alert alert-danger" role="alert">
                <h4 class="alert-heading">Disclaimer</h4>
                <p>
                    <strong>Important: </strong>The authors, reviewers, and
                    editors of this material have made extensive efforts to
                    ensure that treatments, drugs, and discussions about medical
                    practice are accurate and conform to the standards accepted
                    at the time of publication. However, constant changes in
                    information resulting from continuing research and clinical
                    experience, reasonable differences in opinions among
                    authorities, unique aspects of individual clinical
                    situations, and the possibility of human error in preparing
                    such an extensive text mean that other sources of medical
                    information may differ from the information on this site.
                    The information on this site is not intended to be
                    professional advice and is not intended to replace personal
                    consultation with a qualified physician, pharmacist, or
                    other health care professional. The reader should not
                    disregard medical advice or delay seeking it because of
                    something found on this site. <br />Content in the Manuals
                    reflects medical practice and information in the United
                    States. Outside of the United States, clinical guidelines,
                    practice standards, and professional opinion may differ and
                    the reader is advised to also consult local medical sources.
                    Please note, not all content that is available in English is
                    available in every language.
                </p>
            </div>
        </div>

        <script>
            // Data storage
            var loadedPearlsData = [];

            /**
             * Callback for version info
             */
            function version_callback(version) {
                var vSpan = document.getElementById("version");
                if (vSpan) {
                    vSpan.textContent = version || "Unknown";
                }
            }

            /**
             * Function to render a random pearl
             * Separated from the callback to allow manual triggering
             */
            function renderRandomPearl() {
                if (!loadedPearlsData || loadedPearlsData.length === 0) return;

                // Randomly pick one
                var i = Math.floor(Math.random() * loadedPearlsData.length);
                var item = loadedPearlsData[i];

                if (item) {
                    document.getElementById("pearl-title").innerHTML =
                        item.Title || "No Title";
                    document.getElementById("pearl-content").innerHTML =
                        item.Pearl || "No Content";
                }
            }

            /**
             * Callback for Pearls data loading
             */
            function pearls_callback(pearls) {
                // Validation: Check if pearls is a valid array
                if (Array.isArray(pearls) && pearls.length > 0) {
                    loadedPearlsData = pearls;

                    // Render the first random pearl
                    renderRandomPearl();

                    // Enable interactivity
                    var container = document.getElementById("pearl-container");
                    var hint = document.getElementById("pearl-hint");

                    if (container) {
                        container.classList.add("clickable");
                        container.onclick = function () {
                            renderRandomPearl();
                        };
                        container.setAttribute(
                            "title",
                            "Click to show another pearl"
                        );
                    }

                    if (hint) {
                        hint.style.display = "block";
                    }
                } else {
                    // Fallback if data is empty or invalid
                    document.getElementById("pearl-title").textContent = "Info";
                    document.getElementById("pearl-content").textContent =
                        "No Clinical Pearls available at this time.";
                }
            }
        </script>
        <!-- Load scripts at the end -->
        <script
            src="version_portable.js"
            onerror="document.getElementById('version').innerHTML='Error loading version'"
        ></script>
        <script
            src="pearls_portable.js"
            onerror="document.getElementById('pearl-content').innerHTML='Error loading data file'"
        ></script>
        <script>
            localStorage.setItem("popupClicked", "true");
            localStorage.setItem("lastPopupClick", new Date().getTime());
        </script>
    </body>
</html>
